
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Attendee Home</title>

  <!-- bootstrap CSS -->
  <link
    href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
    rel="stylesheet"
  />

  <!-- custom CSS -->
  <link rel="stylesheet" href="/main.css" />
</head>

<!-- body custom theme colours -->
<body class="bg-charcoal text-beige">

  <!-- page container with padding and width limit -->
  <div class="container py-5" style="max-width: 900px;">
    <h1 class="text-heading mb-4">Attendee Home Page</h1>

    <!-- site description section -->
    <div class="bg-mocha-transparent p-3 rounded shadow-sm mb-5 text-center">

      <!-- output: site name from database -->
      <h1 class="display-5 fw-bold mb-3 text-beige"><%= siteName %></h1>

      <!-- output: site description from database -->
      <p class="lead mb-0 text-beige"><%= description %></p>
    </div>

    <!-- upcoming events section -->
    <section class="mt-5">
      <h3 class="text-heading mb-4">Upcoming Events</h3>

      <!-- conditional, show message if no events -->
      <% if (publishedEvents.length === 0) { %>
        <p>No published events yet.</p>
      <% } else { %>
        <ul class="list-group">
          <% publishedEvents.forEach(event => { %>
            <li class="list-group-item bg-slate-box mb-3">

              <!-- event title with link to event details page -->
              <h4 class="mb-2">
                <a href="/attendee/event/<%= event.id %>" class="event-heading-link">
                  <%= event.title %>
                </a>
              </h4>

              <!-- event description -->
              <p class="mb-2"><strong>Description:</strong> <%= event.description %></p>

              <!-- event date and time -->
              <div class="event-datetime-box mb-3 p-2 rounded">
                <p class="mb-1"><strong>Date:</strong> <%= event.date %></p>
                <p class="mb-0"><strong>Time:</strong> <%= event.time || 'Time not set' %></p>
              </div>

              <!-- ticket information -->
              <% if (event.tickets && event.tickets.length > 0) { %>
                <p class="mb-1"><strong>Tickets:</strong></p>
                <div class="ticket-grid">

                  <!-- loop through all ticket types -->
                  <% event.tickets.forEach(ticket => { %>
                    <div class="ticket-card">
                      <div class="ticket-type"><%= ticket.ticket_type %></div>
                      <div class="ticket-price">$<%= ticket.price.toFixed(2) %></div>
                      <div class="ticket-availability">
                        <%= ticket.remaining %> of <%= ticket.original %> available
                      </div>
                    </div>
                    <% }) %>
                  </div>
                  <% } else { %>

                    <!-- if no tickets avail -->
                    <p>No tickets available.</p>
                    <% } %>
            </li>
          <% }) %>
        </ul>
      <% } %>
    </section>

    <!-- navigation button back to main home -->
    <p class="mt-4">
      <a href="/" class="btn btn-slate">Back to Main Home</a>
    </p>
  </div>

</body>
</html>